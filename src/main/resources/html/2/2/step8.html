<div class="container">
    <h2>Операція з'єднання, використання USING()</h2>

    <p>
        Під час опису з'єднання таблиць за допомогою <code>JOIN</code> в деяких випадках замість <code>ON</code> та
        умови після нього можна використовувати оператор <code>USING()</code>.
    </p>

    <p>
        <code>USING</code> дозволяє вказати набір стовпців, які є в обох таблицях, що об'єднуються. Якщо база даних
        добре спроєктована, і кожен зовнішній ключ має таку ж назву, як і відповідний первинний ключ (наприклад,
        <code>genre.genre_id = book.genre_id</code>), тоді можна використовувати конструкцію <code>USING</code> для
        реалізації операції <code>JOIN</code>.
    </p>

    <p>
        При цьому після <code>SELECT</code> не обов'язково вказувати, з якої саме таблиці береться стовпець, якщо він
        зазначений у <code>USING()</code>.
    </p>

    <h3>Приклад</h3>
    <p>Вивести назви книг, прізвища та ID їхніх авторів.</p>

    <p class="skewed">Запит</p>
    <p>Варіант з <code>ON</code></p>
    <pre class="sqlResultTable">SELECT title, name_author, author.author_id
FROM 
    author INNER JOIN book
    ON author.author_id = book.author_id;</pre>

    <p>Варіант з <code>USING</code></p>
    <pre class="sqlResultTable">SELECT title, name_author, author_id
FROM 
    author INNER JOIN book
    USING(author_id);</pre>

    <p class="skewed">Результат (однаковий для обох запитів)</p>
    <pre class="sqlResultTable">+-----------------------+------------------+-----------+
| title                 | name_author      | author_id |
+-----------------------+------------------+-----------+
| Мастер и Маргарита    | Булгаков М.А.    | 1         |
| Белая гвардия         | Булгаков М.А.    | 1         |
| Идиот                 | Достоевский Ф.М.| 2         |
| Братья Карамазовы     | Достоевский Ф.М.| 2         |
| Игрок                 | Достоевский Ф.М.| 2         |
| Стихотворения и поэмы | Есенин С.А.      | 3         |
| Черный человек        | Есенин С.А.      | 3         |
| Лирика                | Пастернак Б.Л.   | 4         |
+-----------------------+------------------+-----------+</pre>

    <p>
        Запис умови з'єднання з <code>ON</code> є більш загальним випадком, оскільки:
    </p>
    <ul>
        <li>дозволяє задавати з'єднання не лише за однойменними полями;</li>
        <li>дозволяє використовувати довільну умову для з'єднання таблиць, зокрема вирази по кількох стовпцях.</li>
    </ul>

    <h3>Приклад</h3>
    <p>У таблиці <code>supply</code> збережена інформація про книги, що надійшли на склад.</p>


    <table class="tableSql">
        <thead>
            <tr>
                <th>supply_id</th>
                <th>title</th>
                <th>author</th>
                <th>price</th>
                <th>amount</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>1</td>
                <td>Доктор Живаго</td>
                <td>Пастернак Б.Л.</td>
                <td>618.99</td>
                <td>3</td>
            </tr>
            <tr>
                <td>2</td>
                <td>Черный человек</td>
                <td>Есенин С.А.</td>
                <td>570.20</td>
                <td>6</td>
            </tr>
            <tr>
                <td>3</td>
                <td>Евгений Онегин</td>
                <td>Пушкин А.С.</td>
                <td>440.80</td>
                <td>5</td>
            </tr>
            <tr>
                <td>4</td>
                <td>Идиот</td>
                <td>Достоевский Ф.М.</td>
                <td>360.80</td>
                <td>3</td>
            </tr>
        </tbody>
    </table>

    <p>Якщо в таблицях <code>supply</code> та <code>book</code> є однакові книги, вивести їхню назву та автора. При
        цьому врахувати, що кілька авторів можуть мати книги з однаковою назвою.</p>

    <p><strong>Увага.</strong> У цьому прикладі використання <code>USING</code> для з'єднання <code>book</code> і
        <code>supply</code> неможливе, тому що:
    </p>
    <ul>
        <li>у таблиці <code>book</code> немає прізвищ авторів (їх потрібно отримати з таблиці <code>author</code> через
            стовпець <code>name_author</code>);</li>
        <li>для однозначної ідентифікації книги потрібно, щоб співпадали і назва, і автор.</li>
    </ul>

    <p class="skewed">Запит:</p>
    <pre class="sqlResultTable">SELECT book.title, name_author
FROM 
    author 
    INNER JOIN book USING (author_id)
    INNER JOIN supply 
        ON book.title = supply.title 
       AND author.name_author = supply.author;</pre>

    <p class="skewed">Результат:</p>
    <pre class="sqlResultTable">+----------------+------------------+
| title          | name_author      |
+----------------+------------------+
| Идиот          | Достоевский Ф.М. |
| Черный человек | Есенин С.А.      |
+----------------+------------------+</pre>

    <h3>Завдання</h3>
    <p>
        Якщо в таблицях <code>supply</code> та <code>book</code> є однакові книги, які мають однакову ціну,
        вивести їхню назву та автора, а також порахувати загальну кількість примірників цих книг у таблицях
        <code>supply</code> та <code>book</code>.
        Стовпці назвати <strong>Назва</strong>, <strong>Автор</strong> та <strong>Кількість</strong>.
    </p>

    <p><strong>Схема даних:</strong></p>

    <div data-img-id="2.2.4.3"></div>

    <p><strong>Текст завдання </strong> (щоб не прокручувати сторінку):</p>
    <p class="gray-quote">
        Якщо в таблицях <code>supply</code> та <code>book</code> є однакові книги, які мають однакову ціну,
        вивести їхню назву та автора, а також порахувати загальну кількість примірників цих книг у таблицях
        <code>supply</code> та <code>book</code>.
        Стовпці назвати <strong>Назва</strong>, <strong>Автор</strong> та <strong>Кількість</strong>.
    </p>



    <div id="toggle1" style="cursor: pointer;">
        <div><span class="arrow-text"><strong>Результат</strong></span></div>
    </div>
    <div id="hiddenText1" style="display:none;">
        <pre class="sqlResultTable">+----------------+-------------+------------+
| Название       | Автор       | Количество |
+----------------+-------------+------------+
| Черный человек | Есенин С.А. | 12         |
+----------------+-------------+------------+</pre>
    </div>

    <br>

    <div id="toggle2" style="cursor: pointer;">
        <div><span class="arrow-text"><strong>Структура та наповнення таблиць</strong></span></div>
    </div>
    <div id="hiddenText2" style="display:none;">
        <pre class="sqlResultTable">Таблица supply:
+-----------+----------------+------------------+--------+--------+
| supply_id | title          | author           | price  | amount |
+-----------+----------------+------------------+--------+--------+
| 1         | Доктор Живаго  | Пастернак Б.Л.   | 618.99 | 3      |
| 2         | Черный человек | Есенин С.А.      | 570.20 | 6      |
| 3         | Евгений Онегин | Пушкин А.С.      | 440.80 | 5      |
| 4         | Идиот          | Достоевский Ф.М. | 360.80 | 3      |
+-----------+----------------+------------------+--------+--------+

Таблица author:
+-----------+------------------+
| author_id | name_author      |
+-----------+------------------+
| 1         | Булгаков М.А.    |
| 2         | Достоевский Ф.М. |
| 3         | Есенин С.А.      |
| 4         | Пастернак Б.Л.   |
| 5         | Лермонтов М.Ю.   |
+-----------+------------------+

Таблица book:
+---------+-----------------------+-----------+----------+--------+--------+
| book_id | title                 | author_id | genre_id | price  | amount |
+---------+-----------------------+-----------+----------+--------+--------+
| 1       | Мастер и Маргарита    | 1         | 1        | 670.99 | 3      |
| 2       | Белая гвардия         | 1         | 1        | 540.50 | 5      |
| 3       | Идиот                 | 2         | 1        | 460.00 | 10     |
| 4       | Братья Карамазовы     | 2         | 1        | 799.01 | 3      |
| 5       | Игрок                 | 2         | 1        | 480.50 | 10     |
| 6       | Стихотворения и поэмы | 3         | 2        | 650.00 | 15     |
| 7       | Черный человек        | 3         | 2        | 570.20 | 6      |
| 8       | Лирика                | 4         | 2        | 518.99 | 2      |
+---------+-----------------------+-----------+----------+--------+--------+</pre>
    </div>


</div>