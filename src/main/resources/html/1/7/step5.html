<div class="container">

    <h2>Збільшення суми штрафу для повторних неоплачених порушень</h2>

    <p>
        У таблиці <code>fine</code> потрібно збільшити вдвічі суму неоплачених штрафів для записів, відібраних на
        попередньому кроці.
    </p>

    <div id="toggle1">
        <div>
            <span class="arrow-text"><strong>Пояснення</strong></span>
        </div>
    </div>
    <div id="hiddenText1">
        <p>
            Якщо не виходить запит або валідатор видає помилки, розгорніть це пояснення!
        </p>
        <ol>
            <li>Для всіх порушень, за якими штраф ще не оплачений (<code>date_payment IS NULL</code>), потрібно
                перевірити, чи є це порушення повторним (тобто цей водій на тій самій машині вже порушував це правило).
            </li>
            <li>Якщо так — суму штрафу потрібно <strong>збільшити вдвічі</strong>.</li>
            <li>Якщо водій порушував правило на іншій машині — штраф не збільшується.</li>
            <li>Якщо є кілька неоплачених повторних порушень — штраф збільшується <strong>для кожного з них</strong>.
            </li>
            <li>Можна використати вкладений запит після <code>UPDATE</code> з псевдонімом, наприклад
                <code>query_in</code>:
            </li>
        </ol>
        <pre class="sqlCodeBlock">UPDATE fine,
    (
      SELECT ...
    ) query_in
SET ...
WHERE fine.name = query_in.name
  AND fine.number_plate = query_in.number_plate
  AND fine.violation = query_in.violation
  AND fine.date_payment IS NULL;</pre>

        <p>Альтернативно — можна спочатку створити тимчасову таблицю <code>query_in</code>, а потім оновити
            <code>fine</code>:
        </p>
        <pre class="sqlCodeBlock">CREATE TABLE query_in AS
SELECT ...

UPDATE fine, query_in
SET fine.sum_fine = fine.sum_fine * 2
WHERE fine.name = query_in.name
  AND fine.number_plate = query_in.number_plate
  AND fine.violation = query_in.violation
  AND fine.date_payment IS NULL;</pre>
    </div>

    <p><strong>Важливо!</strong> Коли використовується кілька таблиць з однаковими назвами стовпців, вказуйте повне
        ім’я: <code>fine.name</code>, <code>query_in.name</code> тощо.</p>

    <p></p>

    <div id="toggle2">
        <div>
            <span class="arrow-text"><strong>Результат</strong></span>
        </div>
    </div>
    <div id="hiddenText2">
        <p>Affected rows: 2</p>
        <pre class="sqlResultTable">+---------------+--------------+----------------------------------+----------+------------------+--------------+
| name          | number_plate | violation                        | sum_fine | date_violation   | date_payment |
+---------------+--------------+----------------------------------+----------+------------------+--------------+
| Баранов П.Е.  | Р523ВТ       | Перевищення швидкості(від 40 до 60) | 500.00   | 2020-01-12       | 2020-01-17   |
| Абрамова К.А. | О111АВ       | Проїзд на заборонний сигнал     | 1000.00  | 2020-01-14       | 2020-02-27   |
| Яковлев Г.Р.  | Т330ТТ       | Перевищення швидкості(від 20 до 40) | 500.00   | 2020-01-23       | 2020-02-23   |
| Яковлев Г.Р.  | М701АА       | Перевищення швидкості(від 20 до 40) | 500.00   | 2020-01-12       | NULL         |
| Колесов С.П.  | К892АХ       | Перевищення швидкості(від 20 до 40) | 500.00   | 2020-02-01       | NULL         |
| Баранов П.Е.  | Р523ВТ       | Перевищення швидкості(від 40 до 60) | 2000.00  | 2020-02-14       | NULL         |
| Абрамова К.А. | О111АВ       | Проїзд на заборонний сигнал     | 2000.00  | 2020-02-23       | NULL         |
| Яковлев Г.Р.  | Т330ТТ       | Проїзд на заборонний сигнал     | 1000.00  | 2020-03-03       | NULL         |
+---------------+--------------+----------------------------------+----------+------------------+--------------+</pre>
    </div>
    <p></p>


    <div id="toggle3">
        <div>
            <span class="arrow-text"><strong>Пов’язані кроки</strong></span>
        </div>
    </div>
    <div id="hiddenText3">
        <ul>
            <li>Оновлення даних (крок за кроком)</li>
            <li>Умови відбору</li>
        </ul>
    </div>

    <p></p>

    <div id="toggle4">
        <div>
            <span class="arrow-text"><strong>Структура і наповнення таблиці <code>fine</code> перед виконанням кроку</strong></span>
        </div>
    </div>
    <div id="hiddenText4">
        <pre class="sqlResultTable">+---------------+--------+------------------------------+----------+----------------+--------------+
| name          | number | violation                    | sum_fine | date_violation | date_payment |
|               | _plate |                              |          |                |              |
+---------------+--------+------------------------------+----------+----------------+--------------+
| Баранов П.Е.  | Р523ВТ | Перевищення швидкості(від 40... | 500.00   | 2020-01-12     | 2020-01-17   |
| Абрамова К.А. | О111АВ | Проїзд на заборонний сигнал     | 1000.00  | 2020-01-14     | 2020-02-27   |
| Яковлев Г.Р.  | Т330ТТ | Перевищення швидкості(від 20... | 500.00   | 2020-01-23     | 2020-02-23   |
| Яковлев Г.Р.  | М701АА | Перевищення швидкості(від 20... | 500.00   | 2020-01-12     | NULL         |
| Колесов С.П.  | К892АХ | Перевищення швидкості(від 20... | 500.00   | 2020-02-01     | NULL         |
| Баранов П.Е.  | Р523ВТ | Перевищення швидкості(від 40... | 1000.00  | 2020-02-14     | NULL         |
| Абрамова К.А. | О111АВ | Проїзд на заборонний сигнал     | 1000.00  | 2020-02-23     | NULL         |
| Яковлев Г.Р.  | Т330ТТ | Проїзд на заборонний сигнал     | 1000.00  | 2020-03-03     | NULL         |
+---------------+--------+------------------------------+----------+----------------+--------------+</pre>
    </div>

</div>