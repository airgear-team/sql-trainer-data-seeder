<div class="container">

    <h2>Групування даних за кількома стовпцями</h2>

    <p>
        У розділі <code>GROUP BY</code> можна вказувати кілька стовпців, розділяючи їх комами. Тоді до однієї групи
        будуть відноситися записи, у яких значення стовпців, що входять у групу, рівні. Розглянемо групування за
        кількома стовпцями на прикладі наступного запиту:
    </p>

    <pre class="sqlCodeBlock">SELECT name, number_plate, violation, count(*)
FROM fine
GROUP BY name, number_plate, violation;</pre>

    <ol>
        <li>
            Спочатку записи таблиці <code>fine</code> поділяються на групи. До кожної групи включаються рядки, у яких
            рівні значення у стовпцях <code>name</code>, <code>number_plate</code> і <code>violation</code> відповідно.
            Отримується 6 груп.
        </li>
        <div data-img-id="1.7.4.1"></div>

        <li>
            Потім обчислюється функція <code>count(*)</code>, яка визначає кількість записів у кожній групі. Виходить,
            що перші дві групи мають по дві записи, решта — по одній.
        </li>
        <div data-img-id="1.7.4.1"></div>

    </ol>

    <p><strong>Важливо!</strong> У розділі <code>GROUP BY</code> потрібно перераховувати всі НЕАГРЕГОВАНІ стовпці (до
        яких не застосовуються агрегатні функції) із <code>SELECT</code>.</p>

    <h3>Завдання</h3>

    <p>
        Вивести прізвище, номер машини та порушення тільки для тих водіїв, які на одній машині порушили одне й те саме
        правило два і більше разів. При цьому враховувати всі порушення, незалежно від того, чи оплачено їх. Інформацію
        відсортувати в алфавітному порядку: спочатку за прізвищем водія, потім за номером машини, і, нарешті, за
        порушенням.
    </p>

    <div id="toggle1">
        <div>
            <span class="arrow-text"><strong>Пояснення</strong></span>
        </div>
    </div>
    <div id="hiddenText1">
        <ol>
            <li>
                Спочатку групуємо записи по трьох стовпцях: <code>name</code>, <code>number_plate</code>,
                <code>violation</code>.
            </li>
            <li>
                Обираємо тільки ті групи, в яких кількість записів &ge; 2 — тобто порушення було скоєне двічі і більше.
            </li>
            <li>
                Враховуємо всі порушення — незалежно від статусу оплати.
            </li>
        </ol>
    </div>

    <p></p>

    <div id="toggle2">
        <div>
            <span class="arrow-text"><strong>Результат</strong></span>
        </div>
    </div>
    <div id="hiddenText2">
        <pre class="sqlResultTable">+---------------+--------------+----------------------------------+
| name          | number_plate | violation                        |
+---------------+--------------+----------------------------------+
| Абрамова К.А. | О111АВ       | Проїзд на заборонний сигнал      |
| Баранов П.Е.  | Р523ВТ       | Перевищення швидкості(від 40 до 60) |
+---------------+--------------+----------------------------------+</pre>
    </div>

    <p></p>


    <div id="toggle3">
        <div>
            <span class="arrow-text"><strong>Пов’язані кроки</strong></span>
        </div>
    </div>
    <div id="hiddenText3">
        <ul>
            <li>Вибірка стовпців;</li>
            <li>Умови відбору в запитах групування;</li>
            <li>Сортування.</li>
        </ul>
    </div>

    <p></p>


    <div id="toggle4">
        <div>
            <span class="arrow-text"><strong>Структура і наповнення таблиці fine (без ключового стовпця) перед
                    виконанням кроку</strong></span>
        </div>
    </div>
    <div id="hiddenText4">
        <pre class="sqlResultTable">+---------------+--------+------------------------------+----------+----------------+--------------+
| name          | number | violation                    | sum_fine | date_violation | date_payment |
|               | _plate |                              |          |                |              |
+---------------+--------+------------------------------+----------+----------------+--------------+
| Баранов П.Е.  | Р523ВТ | Перевищення швидкості(від 40... | 500.00   | 2020-01-12     | 2020-01-17   |
| Абрамова К.А. | О111АВ | Проїзд на заборонний сигнал | 1000.00  | 2020-01-14     | 2020-02-27   |
| Яковлев Г.Р.  | Т330ТТ | Перевищення швидкості(від 20... | 500.00   | 2020-01-23     | 2020-02-23   |
| Яковлев Г.Р.  | М701АА | Перевищення швидкості(від 20... | 500.00   | 2020-01-12     | NULL         |
| Колесов С.П.  | К892АХ | Перевищення швидкості(від 20... | 500.00   | 2020-02-01     | NULL         |
| Баранов П.Е.  | Р523ВТ | Перевищення швидкості(від 40... | 1000.00  | 2020-02-14     | NULL         |
| Абрамова К.А. | О111АВ | Проїзд на заборонний сигнал | 1000.00  | 2020-02-23     | NULL         |
| Яковлев Г.Р.  | Т330ТТ | Проїзд на заборонний сигнал | 1000.00  | 2020-03-03     | NULL         |
+---------------+--------+------------------------------+----------+----------------+--------------+</pre>
    </div>

</div>