<div class="container">
    <h2>Вибірка даних, групові функції SUM та COUNT</h2>

    <p>При групуванні елементів стовпця, що входять до групи, можна виконувати різні дії, наприклад, підсумовувати їх
        або підраховувати кількість елементів у групі.</p>

    <p>Детально розглянемо, як виконується групування даних за певним стовпцем і обчислення над групою на наступному
        прикладі:</p>

    <pre class="sqlCodeBlock">SELECT author, SUM(amount), COUNT(amount)
FROM book
GROUP BY author;</pre>

    <p>1. У таблиці <code>book</code> визначаються рядки, у яких у стовпці <code>author</code> однакові значення.</p>

    <p>Оскільки кожен автор у нашій таблиці зустрічається лише один раз, групи будуть такими:</p>
    <ul style="list-style-type: disc;">
        <li><strong>Нечуй-Левицький І.С.</strong></li>
        <li><strong>Коцюбинський М.М.</strong></li>
        <li><strong>Шевченко Т.Г.</strong></li>
        <li><strong>Квітка-Основʼяненко Г.Ф.</strong></li>
        <li><strong>Леся Українка</strong></li>
    </ul>

    <p>2. Замість кожної групи у результаті запиту відображається один запис, який містить значення стовпця, за яким
        виконується групування (у нашому випадку — <code>author</code>).</p>

    <p>3. Далі можна виконати обчислення над елементами кожної групи окремо, наприклад, підрахувати загальну кількість
        примірників книг кожного автора. Для цього використовується групова функція <code>SUM()</code>, у дужках якої
        вказується стовпець для сумування (<code>amount</code>).</p>

    <p>4. Також можна порахувати, скільки записів належить до групи. Для цього застосовується функція
        <code>COUNT()</code>.</p>

    <p><strong>Приклад</strong></p>

    <p>Порахувати, скільки примірників книг кожного автора зберігається на складі.</p>

    <pre class="sqlCodeBlock">SELECT author, SUM(amount)
FROM book
GROUP BY author;</pre>

    <p class="skewed">Результат:</p>

    <pre class="sqlResultTable">+-------------------------+-------------+
| author                  | SUM(amount) |
+-------------------------+-------------+
| Нечуй-Левицький І.С.    | 3           |
| Коцюбинський М.М.       | 5           |
| Шевченко Т.Г.           | 10          |
| Квітка-Основʼяненко Г.Ф.| 2           |
| Леся Українка           | 7           |
+-------------------------+-------------+</pre>

    <div id="toggle2" style="cursor: pointer;">
        <div>
            <span class="arrow-text"><strong>Примітка</strong></span>
        </div>
    </div>

    <div id="hiddenText2" style="display:none;">
        <p>Зверніть увагу, що у результаті назва обчислюваного стовпця — це вираз. Рекомендується
            давати обчислюваним стовпцям імена.</p>
    </div>


    <p><strong>Приклад з NULL</strong></p>

    <p>Для цього прикладу до таблиці <code>book</code> додано запис із порожніми значеннями у стовпцях
        <code>amount</code> та <code>price</code>:</p>

    <pre class="sqlResultTable">+---------+-----------------------+-------------------------+--------+--------+
| book_id | title                 | author                  | price  | amount |
+---------+-----------------------+-------------------------+--------+--------+
| 1       | Кайдашева сімʼя       | Нечуй-Левицький І.С.    | 320.50 | 3      |
| 2       | Тіні забутих предків  | Коцюбинський М.М.       | 410.00 | 5      |
| 3       | Кобзар                | Шевченко Т.Г.           | 520.00 | 10     |
| 4       | Маруся                | Квітка-Основʼяненко Г.Ф.| 300.00 | 2      |
| 5       | Лісова пісня          | Леся Українка           | 450.00 | 7      |
| 6       | Без назви             | Леся Українка           | NULL   | NULL   |
+---------+-----------------------+-------------------------+--------+--------+</pre>

    <p class="skewed">Запит:</p>

    <pre class="sqlCodeBlock">/* щоб перевірити запит, додайте рядок у таблицю */
INSERT INTO book (title, author, price, amount)
VALUES ('Без назви','Леся Українка', NULL, NULL);

SELECT author, COUNT(author), COUNT(amount), COUNT(*)
FROM book
GROUP BY author;</pre>

    <p class="skewed">Результат:</p>

    <pre class="sqlResultTable">+-------------------------+---------------+---------------+----------+
| author                  | COUNT(author) | COUNT(amount) | COUNT(*) |
+-------------------------+---------------+---------------+----------+
| Нечуй-Левицький І.С.    | 1             | 1             | 1        |
| Коцюбинський М.М.       | 1             | 1             | 1        |
| Шевченко Т.Г.           | 1             | 1             | 1        |
| Квітка-Основʼяненко Г.Ф.| 1             | 1             | 1        |
| Леся Українка           | 2             | 1             | 2        |
+-------------------------+---------------+---------------+----------+</pre>

    <p>З таблиці видно:</p>
    <ul style="list-style-type: disc;">
        <li><code>COUNT(*)</code> — рахує всі записи, в тому числі з <code>NULL</code>;</li>
        <li><code>COUNT(назва_стовпця)</code> — враховує лише записи без <code>NULL</code>.</li>
    </ul>

    <h2>Завдання</h2>

    <p>Порахувати кількість різних книг та кількість примірників книг кожного автора. Назвати
        стовпці <code>Автор</code>, <code>Різних_книг</code> та <code>Кількість_примірників</code>.</p>

    <div id="toggle3" style="cursor: pointer;">
        <div>
            <span class="arrow-text"><strong>Результат</strong></span>
        </div>
    </div>

    <div id="hiddenText3" style="display:none;">
        <pre class="sqlResultTable">+-------------------------+--------------+------------------------+
| Автор                   | Різних_книг  | Кількість_примірників  |
+-------------------------+--------------+------------------------+
| Нечуй-Левицький І.С.    | 1            | 3                      |
| Коцюбинський М.М.       | 1            | 5                      |
| Шевченко Т.Г.           | 1            | 10                     |
| Квітка-Основʼяненко Г.Ф.| 1            | 2                      |
| Леся Українка           | 2            | 7                      |
+-------------------------+--------------+------------------------+</pre>
    </div>

    <div id="toggle4" style="cursor: pointer;">
        <div>
            <span class="arrow-text"><strong>Пояснення</strong></span>
        </div>
    </div>

    <div id="hiddenText4" style="display:none;">
        <p>
            Назва стовпців може складатися з кількох слів — у такому випадку її потрібно брати в лапки. Але якщо слова
            з’єднати підкресленням, тоді лапки можна не використовувати.
        </p>
    </div>

    <div id="toggle5" style="cursor: pointer;">
        <div>
            <span class="arrow-text"><strong>Структура та наповнення таблиці <code>book</code></strong></span>
        </div>
    </div>

    <div id="hiddenText5" style="display:none;">
        <pre class="sqlResultTable">+---------+-----------------------+-------------------------+--------+--------+
| book_id | title                 | author                  | price  | amount |
+---------+-----------------------+-------------------------+--------+--------+
| 1       | Кайдашева сімʼя       | Нечуй-Левицький І.С.    | 320.50 | 3      |
| 2       | Тіні забутих предків  | Коцюбинський М.М.       | 410.00 | 5      |
| 3       | Кобзар                | Шевченко Т.Г.           | 520.00 | 10     |
| 4       | Маруся                | Квітка-Основʼяненко Г.Ф.| 300.00 | 2      |
| 5       | Лісова пісня          | Леся Українка           | 450.00 | 7      |
+---------+-----------------------+-------------------------+--------+--------+</pre>
    </div>
</div>
