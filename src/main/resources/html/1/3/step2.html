<div class="container">
    <h2>Вибірка даних, групові функції SUM та COUNT</h2>

    <p>При групуванні елементів стовпця, що входять до групи, можна виконувати різні дії, наприклад, підсумовувати їх
        або підраховувати кількість елементів у групі.</p>

    <p>Детально розглянемо, як виконується групування даних за певним стовпцем і обчислення над групою на наступному
        прикладі:</p>

    <pre class="sqlCodeBlock">SELECT author, SUM(amount), COUNT(amount)
FROM book
GROUP BY author;</pre>

    <p>1. У таблиці <code>book</code> визначаються рядки, у яких у стовпці <code>author</code> однакові значення:</p>

    <div data-img-id="1.3.2.1"></div>

    <p>Отримали 3 різні групи:</p>
    <ul style="list-style-type: disc;">
        <li>група I об’єднує два записи з автором <strong>Булгаков М.А.</strong>;</li>
        <li>група II об’єднує три записи з автором <strong>Достоевский Ф.М.</strong>;</li>
        <li>група III об’єднує один запис з автором <strong>Есенин С.А.</strong>.</li>
    </ul>

    <p>2. Замість кожної групи у результаті запиту відображається один запис, який містить значення стовпця, за яким
        виконується групування (у нашому випадку — <code>author</code>):</p>

    <div data-img-id="1.3.2.2"></div>

    <p>3. Далі можна виконати обчислення над елементами кожної групи окремо, наприклад, підрахувати загальну кількість
        примірників книг кожного автора. Для цього використовується групова функція <code>SUM()</code>, у дужках якої
        вказується стовпець для сумування (у нашому випадку — <code>amount</code>):</p>

    <div data-img-id="1.3.2.3"></div>

    <p>4. Також можна порахувати, скільки записів належить до групи. Для цього застосовується функція
        <code>COUNT()</code>, у дужках можна вказати будь-який стовпець із групи, якщо у групі немає порожніх значень.
        Нижче наведено приклад, який показує, як працює <code>COUNT()</code>, якщо в групі є порожні (NULL) значення:
    </p>

    <div data-img-id="1.3.2.4"></div>

  <p><strong>Приклад</strong></p>

    <p>Порахувати, скільки примірників книг кожного автора зберігається на складі.</p>

    <pre class="sqlCodeBlock">SELECT author, SUM(amount)
FROM book
GROUP BY author;</pre>

    <p class="skewed">Результат:</p>

    <pre class="sqlResultTable">+------------------+-------------+
| author           | SUM(amount) |
+------------------+-------------+
| Булгаков М.А.    | 8           |
| Достоевский Ф.М. | 23          |
| Есенин С.А.      | 15          |
+------------------+-------------+</pre>

    <div id="toggle2" style="cursor: pointer;">
        <div>
            <span class="arrow-text"><strong>Примітка</strong></span>
        </div>
    </div>

    <div id="hiddenText2" style="display:none;">
        <p>Зверніть увагу, що у результаті назва обчислюваного стовпця — це вираз. Рекомендується
            давати обчислюваним стовпцям імена.</p>
    </div>




  <p><strong>Приклад</strong></p>

    <p>Порахувати, скільки різних книг кожного автора зберігається на складі.</p>

    <p>Для цього прикладу до таблиці <code>book</code> додано запис із порожніми значеннями у стовпцях
        <code>amount</code> та <code>price</code>:
    </p>

    <pre class="sqlResultTable">+---------+-----------------------+------------------+--------+--------+
| book_id | title                 | author           | price  | amount |
+---------+-----------------------+------------------+--------+--------+
| 1       | Мастер и Маргарита    | Булгаков М.А.    | 670.99 | 3      |
| 2       | Белая гвардия         | Булгаков М.А.    | 540.50 | 5      |
| 3       | Идиот                 | Достоевский Ф.М. | 460.00 | 10     |
| 4       | Братья Карамазовы     | Достоевский Ф.М. | 799.01 | 3      |
| 5       | Игрок                 | Достоевский Ф.М. | 480.50 | 10     |
| 6       | Стихотворения и поэмы | Есенин С.А.      | 650.00 | 15     |
| 7       | Черный человек        | Есенин С.А.      | Null   | Null   |
+---------+-----------------------+------------------+--------+--------+</pre>


    <p class="skewed">Запит:</p>


    <pre class="sqlCodeBlock">/* щоб перевірити запит, додайте рядок у таблицю */
INSERT INTO book (title, author, price, amount) VALUES ('Черный человек','Есенин С.А.', NULL, NULL);

SELECT author, COUNT(author), COUNT(amount), COUNT(*)
FROM book
GROUP BY author;</pre>

    <p class="skewed">Результат:</p>

    <pre class="sqlResultTable">+------------------+---------------+---------------+----------+
| author           | COUNT(author) | COUNT(amount) | COUNT(*) |
+------------------+---------------+---------------+----------+
| Булгаков М.А.    | 2             | 2             | 2        |
| Достоевский Ф.М. | 3             | 3             | 3        |
| Есенин С.А.      | 2             | 1             | 2        |
+------------------+---------------+---------------+----------+</pre>

    <p>З таблиці з результатами видно, що функцію <code>COUNT()</code> можна застосовувати до будь-якого стовпця, в тому
        числі використовувати <code>*</code>, якщо таблиця не містить порожніх значень. Якщо ж у стовпцях є значення
        <code>NULL</code> (як у групі авторів <strong>Есенин С.А.</strong> у нашому прикладі), то:
    </p>

    <ul style="list-style-type: disc;">
        <li><code>COUNT(*)</code> — підраховує всі записи, що належать до групи, в тому числі з <code>NULL</code>;</li>
        <li><code>COUNT(назва_стовпця)</code> — рахує кількість записів конкретного стовпця, враховуючи лише
            <code>NOT NULL</code>.
        </li>
    </ul>

    <p><strong>ВАЖЛИВО</strong></p>
    <ul>
        <li>
            Якщо стовпець вказано в <code>SELECT</code> без групової функції, його обов’язково
            потрібно включати у <code>GROUP BY</code>. Інакше буде помилка.
        </li>
        <li>
            Між назвою функції та дужкою не можна ставити пробіл — це особливість платформи.
        </li>
    </ul>


    <h2>Завдання</h2>

    <p>Порахувати кількість різних книг та кількість примірників книг кожного автора, що зберігаються на складі. Назвати
        стовпці <code>Автор</code>, <code>Різних_книг</code> та <code>Кількість_примірників</code> відповідно.</p>





    <div id="toggle3" style="cursor: pointer;">
        <div>
            <span class="arrow-text"><strong>Результат</strong></span>
        </div>
    </div>

    <div id="hiddenText3" style="display:none;">
        <pre class="sqlResultTable">+------------------+----------------+------------------------+
| Автор            | Различных_книг | Количество_экземпляров |
+------------------+----------------+------------------------+
| Булгаков М.А.    | 2              | 8                      |
| Достоевский Ф.М. | 3              | 23                     |
| Есенин С.А.      | 1              | 15                     |
+------------------+----------------+------------------------+</pre>

    </div>



    <p></p>

    <div id="toggle4" style="cursor: pointer;">
        <div>
            <span class="arrow-text"><strong>Пояснення</strong></span>
        </div>
    </div>

    <div id="hiddenText4" style="display:none;">
        <p>
            Назва стовпців може складатися з кількох слів — у такому випадку її потрібно брати в лапки. Але якщо слова
            з’єднати підкресленням, тоді назва вважатиметься одним словом, і лапки можна не використовувати.
        </p>
    </div>

    <p></p>

    <div id="toggle5" style="cursor: pointer;">
        <div>
            <span class="arrow-text"><strong>Структура та наповнення таблиці <code>book</code></strong></span>
        </div>
    </div>

    <div id="hiddenText5" style="display:none;">
        <pre class="sqlResultTable">+---------+-----------------------+------------------+--------+--------+
| book_id | title                 | author           | price  | amount |
+---------+-----------------------+------------------+--------+--------+
| 1       | Мастер и Маргарита    | Булгаков М.А.    | 670.99 | 3      |
| 2       | Белая гвардия         | Булгаков М.А.    | 540.50 | 5      |
| 3       | Идиот                 | Достоевский Ф.М. | 460.00 | 10     |
| 4       | Братья Карамазовы     | Достоевский Ф.М. | 799.01 | 3      |
| 5       | Игрок                 | Достоевский Ф.М. | 480.50 | 10     |
| 6       | Стихотворения и поэмы | Есенин С.А.      | 650.00 | 15     |
+---------+-----------------------+------------------+--------+--------+</pre>

    </div>
</div>