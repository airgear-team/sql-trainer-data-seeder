<div class="container">
    <h2>Вибірка даних, групові функції SUM та COUNT</h2>

    <p>При групуванні елементів стовпця, що входять до групи, можна виконувати різні дії, наприклад, підсумовувати їх
        або підраховувати кількість елементів у групі.</p>

    <p>Детально розглянемо, як виконується групування даних за певним стовпцем і обчислення над групою на наступному
        прикладі:</p>

    <pre class="sqlCodeBlock">SELECT author, SUM(amount), COUNT(amount)
FROM book
GROUP BY author;</pre>

    <p>1. У таблиці <code>book</code> визначаються рядки, у яких у стовпці <code>author</code> однакові значення.</p>

    <p>Оскільки деякі автори у нашій таблиці зустрічаються більше одного разу, групи будуть такими:</p>
    <ul style="list-style-type: disc;">
        <li><strong>Коцюбинський М.М.</strong></li>
        <li><strong>Нечуй-Левицький І.С.</strong></li>
        <li><strong>Кобилянська О.Ю.</strong></li>
    </ul>

    <p>2. Замість кожної групи у результаті запиту відображається один запис, який містить значення стовпця, за яким
        виконується групування (у нашому випадку — <code>author</code>).</p>

    <p>3. Далі можна виконати обчислення над елементами кожної групи окремо, наприклад, підрахувати загальну кількість
        примірників книг кожного автора. Для цього використовується групова функція <code>SUM()</code>, у дужках якої
        вказується стовпець для сумування (<code>amount</code>).</p>

    <p>4. Також можна порахувати, скільки записів належить до групи. Для цього застосовується функція
        <code>COUNT()</code>.</p>

    <p><strong>Приклад</strong></p>

    <p>Порахувати, скільки примірників книг кожного автора зберігається на складі.</p>

    <pre class="sqlCodeBlock">SELECT author, SUM(amount)
FROM book
GROUP BY author;</pre>

    <p class="skewed">Результат:</p>

    <pre class="sqlResultTable">+----------------------+-------------+
| author               | sum(amount) |
+----------------------+-------------+
| Коцюбинський М.М.    | 8           |
| Нечуй-Левицький І.С. | 12          |
| Кобилянська О.Ю.     | 15          |
+----------------------+-------------+</pre>

    <div id="toggle2" style="cursor: pointer;">
        <div>
            <span class="arrow-text"><strong>Примітка</strong></span>
        </div>
    </div>

    <div id="hiddenText2" style="display:none;">
        <p>Зверніть увагу, що у результаті назва обчислюваного стовпця — це вираз. Рекомендується
            давати обчислюваним стовпцям імена.</p>
    </div>


    <p><strong>Приклад з NULL</strong></p>

    <p>Для цього прикладу до таблиці <code>book</code> додано запис із порожніми значеннями у стовпцях
        <code>amount</code> та <code>price</code>:</p>

    <pre class="sqlResultTable">+---------+----------------------+----------------------+--------+--------+
| book_id | title                | author               | amount | price  |
+---------+----------------------+----------------------+--------+--------+
| 1       | Тіні забутих предків | Коцюбинський М.М.    | 3      | 670.99 |
| 2       | Intermezzo           | Коцюбинський М.М.    | 5      | 540.5  |
| 3       | Кайдашева сім’я      | Нечуй-Левицький І.С. | 10     | 460    |
| 4       | Хмари                | Нечуй-Левицький І.С. | 2      | 799.01 |
| 5       | Земля                | Кобилянська О.Ю.     | 15     | 650    |
| 6       | Без назви            | Кобилянська О.Ю.     | NULL   | NULL   |
+---------+----------------------+----------------------+--------+--------+</pre>

    <p class="skewed">Запит:</p>

    <pre class="sqlCodeBlock">/* щоб перевірити запит, додайте рядок у таблицю */
INSERT INTO book (title, author, price, amount)
VALUES ('Без назви','Кобилянська О.Ю.', NULL, NULL);

SELECT author, COUNT(author), COUNT(amount), COUNT(*)
FROM book
GROUP BY author;</pre>

    <p class="skewed">Результат:</p>

    <pre class="sqlResultTable">+----------------------+---------------+---------------+----------+
| author               | count(author) | count(amount) | count(*) |
+----------------------+---------------+---------------+----------+
| Коцюбинський М.М.    | 2             | 2             | 2        |
| Нечуй-Левицький І.С. | 2             | 2             | 2        |
| Кобилянська О.Ю.     | 2             | 1             | 2        |
+----------------------+---------------+---------------+----------+</pre>

    <p>З таблиці видно:</p>
    <ul style="list-style-type: disc;">
        <li><code>COUNT(*)</code> — рахує всі записи, в тому числі з <code>NULL</code>;</li>
        <li><code>COUNT(назва_стовпця)</code> — враховує лише записи без <code>NULL</code>.</li>
    </ul>

    <h2>Завдання</h2>

    <p>Порахувати кількість різних книг та кількість примірників книг кожного автора. Назвати
        стовпці <code>Автор</code>, <code>Різних_книг</code> та <code>Кількість_примірників</code>.</p>

    <div id="toggle3" style="cursor: pointer;">
        <div>
            <span class="arrow-text"><strong>Результат</strong></span>
        </div>
    </div>

    <p></p>

    <div id="hiddenText3" style="display:none;">
        <pre class="sqlResultTable">+----------------------+-------------+-----------------------+
| Автор                | різних_книг | кількість_примірників |
+----------------------+-------------+-----------------------+
| Кобилянська О.Ю.     | 1           | 15                    |
| Коцюбинський М.М.    | 2           | 8                     |
| Нечуй-Левицький І.С. | 2           | 12                    |
+----------------------+-------------+-----------------------+</pre>
    </div>

    <p></p>

    <div id="toggle4" style="cursor: pointer;">
        <div>
            <span class="arrow-text"><strong>Пояснення</strong></span>
        </div>
    </div>

    <div id="hiddenText4" style="display:none;">
        <p>
            Назва стовпців може складатися з кількох слів — у такому випадку її потрібно брати в лапки. Але якщо слова
            з’єднати підкресленням, тоді лапки можна не використовувати.
        </p>
    </div>

    <p></p>

    <div id="toggle5" style="cursor: pointer;">
        <div>
            <span class="arrow-text"><strong>Структура та наповнення таблиці <code>book</code></strong></span>
        </div>
    </div>

    <div id="hiddenText5" style="display:none;">
        <pre class="sqlResultTable">+---------+----------------------+----------------------+--------+--------+
| book_id | title                | author               | amount | price  |
+---------+----------------------+----------------------+--------+--------+
| 1       | Тіні забутих предків | Коцюбинський М.М.    | 3      | 670.99 |
| 2       | Intermezzo           | Коцюбинський М.М.    | 5      | 540.5  |
| 3       | Кайдашева сім’я      | Нечуй-Левицький І.С. | 10     | 460    |
| 4       | Хмари                | Нечуй-Левицький І.С. | 2      | 799.01 |
| 5       | Земля                | Кобилянська О.Ю.     | 15     | 650    |
+---------+----------------------+----------------------+--------+--------+</pre>
    </div>
</div>
